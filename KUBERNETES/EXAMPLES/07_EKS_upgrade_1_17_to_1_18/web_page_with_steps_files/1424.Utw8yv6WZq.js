(self._cf=self._cf||[]).push([[1424],{901424:(e,t,n)=>{"use strict";n.r(t),n.d(t,{ProfileComponent:()=>ae});var o=n(159394),a=n(547313),i=n(202784),l=n(286235),r=n(830691),s=n(51681),c=n(639409),d=n(156274),u=n(810738),p=n(556853),m=n(454530),g=n(607560),E=n(619208),f=n(133137);const h=e=>{const{tooltip:t}=e,n=(0,m.Z)(e,["tooltip"]);return i.createElement(f.h,(0,g.Z)({icon:i.createElement(E.default,{label:"string"==typeof t?t:"Sign-in Icon"}),tooltip:t},n))},I=f.h;var v=n(41001),w=n(358056),b=n(544289),S=n(539099),A=n(134163),U=n(164464),P=n(557098),_=n(948125),C=n(180213),y=n(581457),O=n(847241),F=n(196510),R=n(920670),T=n(221241),L=n(328230),M=n(315783);const x={[R.ax.PRE_TRIAL]:"preTrialMenu"},N=(0,a.Z)("div",{target:"ep2j36n0"})({name:"4knjz3",styles:"display:flex;flex-wrap:nowrap;"}),Z=(0,a.Z)("div",{target:"ep2j36n1"})({name:"1atez51",styles:"margin:-1px 0px 0px 8px;"}),D=(0,r.vU)({persistentUpgradeMenuItemFreePlanTitle:{id:"persistent-upgrade.section.message.persistent-upgrade.menuitem.freeplan.title",defaultMessage:"UPGRADE",description:"Account profile menu item title for free plan"},persistentUpgradeMenuItemFreePlanLabel:{id:"persistent-upgrade.section.message.persistent-upgrade.menuitem.freeplan.label",defaultMessage:"{trialLength, plural, one {#-day} other {#-day}} trial of Standard",description:"Account profile menu item label for free plan, trialLength is the default trial duration in days (e.g. 30)."},persistentUpgradeMenuItemFreePlanLozenge:{id:"persistent-upgrade.section.message.persistent-upgrade.menuitem.freeplan.lozenge",defaultMessage:"TRY FOR FREE",description:"Account profile menu item lozenge for free plan"}}),j=()=>{const{createAnalyticsEvent:e}=(0,s._)(),{currentEdition:t}=(0,i.useContext)(y.Ag),n=(0,M.TW)(R.AW)?R.cD:R.L7;return(0,i.useEffect)((()=>{t&&e((0,T.Zr)((0,o.Z)({eventAction:"viewed"},k(t)))).fire()}),[e,t]),i.createElement(N,null,i.createElement(r._H,(0,o.Z)((0,o.Z)({},D.persistentUpgradeMenuItemFreePlanLabel),{},{values:{trialLength:n}})),i.createElement(Z,null,i.createElement(L.Z,{appearance:"inprogress",isBold:!0},i.createElement(r._H,(0,o.Z)({},D.persistentUpgradeMenuItemFreePlanLozenge)))))};j.displayName="PersistentUpgradeMenuItem";const k=e=>({touchpointSubject:"persistentUpgradeMenu",currentEdition:e,touchpointId:x[R.ax.PRE_TRIAL],flowId:R.pu});var W=n(581316),z=n(744052),G=n(347415),H=n(939686);const V=["confluence.user.menu:user-favourites"];const B=(0,i.memo)((({webItems:e,webSections:t,userId:n,dialogFn:a,onClose:l,scheduleUpdate:r})=>{const c=(()=>{const[e,t]=(0,i.useState)(!1),{createAnalyticsEvent:n}=(0,s._)(),{currentEdition:a,cloudId:l,isSiteAdmin:r,showUpFlow:c}=(0,i.useContext)(y.Ag),d=(0,i.useCallback)((()=>{n((0,T.Zr)((0,o.Z)({eventAction:"clicked"},k(a)))).fire(),c({touchpointId:x[R.ax.PRE_TRIAL],flow:R.E7,targetEdition:O.m.STANDARD,epMessageId:F.Cl})}),[n,a,c]);if(a===O.m.FREE&&Boolean(r)&&Boolean(l)&&!e)return[{heading:D.persistentUpgradeMenuItemFreePlanTitle,items:[{action:d,content:i.createElement(_.k,{attribution:C.x.GROWTH_UPFLOW,onError:()=>t(!0)},i.createElement(j,null))}]}];return[]})(),d=(0,z.M)(e,t,n);return i.createElement(G.Z,{testId:"app-navigation-profile-menu",menuItems:[...c,...d],dialogFn:a,onClose:l,popupKey:W.dG,scheduleUpdate:r,experienceName:P.q.APP_NAV_PROFILE_DROPDOWN})})),q=(0,i.memo)((e=>i.createElement(H.X,{experienceName:P.q.APP_NAV_PROFILE_DROPDOWN},i.createElement(U.e,null,(({userId:t})=>i.createElement(b.p,{location:S.Y.SYSTEM_USER,hasMultipleSections:!0,notAllowedWebItems:V},(({webItems:n,webSections:a})=>i.createElement(B,(0,o.Z)((0,o.Z)({},e),{},{userId:t,webItems:n,webSections:a})))))))));var Y=n(494775),K=n(248839),J=n(772005),Q=n(899064),$=n(230382);const X=n.n($)()`query ProfileQuery{user(current:true){id displayName photos{value isPrimary}}}`,ee=`${Y.b}/login.action?os_destination=${window.location.pathname.replace(Y.b,"")}`,te=(0,r.vU)({signIn:{id:"app-navigation.sign.in.tooltip",defaultMessage:"Sign In",description:"a tooltip directing the user to sign into the app"}}),ne=(0,a.Z)("div",{target:"e7v5jnn0"})({name:"y7nl8n",styles:"max-height:calc(100vh - 76px);"}),oe=(0,a.Z)("div",{target:"e7v5jnn1"})({name:"fhbt6x",styles:"width:36px;height:36px;"}),ae=(0,r.XN)((({intl:e,openDialog:t,isOpen:n,onClose:a,onClick:r})=>{const{match:m}=(0,i.useContext)(c.M),{createAnalyticsEvent:g}=(0,s._)(),{data:E,loading:f}=(0,l.aM)(X),{isAnonymous:b,loading:U}=(0,i.useContext)(Q.wu),_=(0,i.useCallback)((()=>{(0,J.OV)().abort({name:P.q.APP_NAV_PROFILE_DROPDOWN,reason:"dropdown closed by user"}),a()}),[a]),C=(0,i.useCallback)((()=>{g({type:"sendUIEvent",data:{source:"globalNavigation",action:"clicked",actionSubject:"navigationItem",actionSubjectId:"login",attributes:{selectedItemPageContext:m?m.name:void 0,navigationLayer:"global",navVersion:"3",navdexPointType:K.Om.START_TOUCH}}}).fire()}),[m,g]),y=(0,i.useCallback)((()=>{r(),n&&_(),g({type:"sendUIEvent",data:{source:"globalNavigation",action:"clicked",actionSubject:"navigationItem",actionSubjectId:"profile",attributes:{selectedItemPageContext:m?m.name:void 0,navigationLayer:"global",navVersion:"3",navdexPointType:K.Om.START_TOUCH}}}).fire()}),[n,_,r,m,g]);if((0,i.useEffect)((()=>{(0,A.M)({location:S.Y.SYSTEM_USER})}),[]),f||U)return i.createElement(oe,null);if(b)return i.createElement("span",{"data-testid":"app-navigation-login",onClick:C},i.createElement(h,{tooltip:e.formatMessage(te.signIn),href:ee}));{var O,F;const e=(null!=(F=E)?F.user:F)||{photos:[],displayName:null,id:null},a=null!=(O=e)&&null!=(O=O.photos)&&null!=(O=O[0])?O.value:O,l=e.displayName?e.displayName:null,r=i.createElement(v.Z,{src:a,size:"small"});return i.createElement(w.Z,{isOpen:n,onClose:_,offset:[14,0],content:({update:e})=>i.createElement(ne,null,i.createElement(q,{onClose:_,dialogFn:t,scheduleUpdate:e})),trigger:e=>i.createElement("span",{"data-testid":"app-navigation-profile"},i.createElement(u.ZP,null,i.createElement(p.Z,{name:"nav-profile"},i.createElement(I,(0,o.Z)((0,o.Z)({},e),{},{icon:r,onClick:y,tooltip:l,isSelected:n}))),i.createElement(d.ZP,{engagementId:"nav-profile"}))),placement:"bottom-end"})}}))},581457:(e,t,n)=>{"use strict";n.d(t,{Ag:()=>f,H2:()=>I});var o=n(159394),a=n(202784),i=n(286235),l=n(210022),r=n(899064),s=n(948125),c=n(180213),d=n(885255),u=n(557098),p=n(847241),m=n(272086),g=n(145795);const E=(0,n(768606).P)({__loadable_id__:"J1ypV",name:"UpFlowLoadable",loader:async()=>(await Promise.all([n.e(78248),n.e(11216),n.e(90045)]).then(n.bind(n,390045))).UpFlowComponent}),f=(0,a.createContext)({shouldShowUpFlow:!1,isSiteAdmin:!1,cloudId:"",currentEdition:void 0,showUpFlow:()=>{},hideUpFlow:()=>{}}),h={shouldShowUpFlow:!1,touchpointId:"",targetEdition:p.m.STANDARD,flow:"",epMessageId:""},I=({children:e})=>{const[t,n]=(0,a.useState)(h),{shouldShowUpFlow:p,targetEdition:I,flow:v,touchpointId:w,epMessageId:b}=t,[S,A]=(0,a.useState)(),{isSiteAdmin:U,tenantId:P}=(0,a.useContext)(r.wu),_=(0,a.useContext)(d.F),{data:C}=(0,i.aM)(g.D,{}),y=()=>{n((0,o.Z)((0,o.Z)({},t),{},{shouldShowUpFlow:!1,touchpointId:"",flow:"",epMessageId:""}))},O=(0,a.useCallback)((e=>{_.stopOnError({name:u.q.UPSELL_EDITION,error:e})}),[_]);(0,a.useEffect)((()=>{A((0,m._)(C))}),[C]);const F={shouldShowUpFlow:p,isSiteAdmin:U,cloudId:P,currentEdition:S,showUpFlow:e=>{_.start({name:u.q.UPSELL_EDITION,attributes:{currentEdition:S,targetEdition:e.targetEdition,experience:u.q.UPSELL_EDITION,experienceId:e.touchpointId}}),n((0,o.Z)((0,o.Z)({},e),{},{shouldShowUpFlow:!0}))},hideUpFlow:y};return a.createElement(f.Provider,{value:F},e,p&&I&&v?a.createElement(s.k,{attribution:c.x.GROWTH_UPFLOW,onError:O},a.createElement(E,{priority:l.U.BACKGROUND,canChangeEdition:U,cloudId:P,currentEdition:S,flow:v,product:"confluence",targetEdition:I,touchpointId:w,onClose:y,onOpen:()=>{},epMessageId:b,isExperienceTrackerEnabled:!0})):null)};I.displayName="UpFlowProvider";const{Consumer:v}=f},196510:(e,t,n)=>{"use strict";n.d(t,{W4:()=>o,Gv:()=>a,Oi:()=>i,NK:()=>l,IO:()=>r,on:()=>s,dj:()=>c,cI:()=>d,zN:()=>u,er:()=>p,Cl:()=>m,RD:()=>g,$1:()=>E,Gx:()=>f,EG:()=>h});const o="https://confluence.atlassian.com/display/ConfCloud/Confluence+Cloud+plans",a="confluence-change-edition-section-message",i="confluence-change-edition-remove-restrictions-button",l="confluence-change-edition-notification-dialog",r=3,s=10,c="/admin/billing/applications/change-edition/confluence.ondemand";let d;!function(e){e.DEFAULT="default",e.FLAT="flat",e.INLINE="inline",e.INLINE_MODAL="inline-modal"}(d||(d={}));const u="confluence.frontend.show.standard.upsell",p="confluence-up-flow-modal",m="upflow-confluence-persistent-upgrade",g="upflow-confluence-upgrade-for-admins",E="upflow-confluence-billing-for-admins",f="engaged-upgrade",h="engaged-billing";let I;!function(e){e.CONFLUENCE="confluence.ondemand",e.JIRA_CORE="jira-core.ondemand",e.JIRA_SERVICE_DESK="jira-servicedesk.ondemand",e.JIRA_SOFTWARE="jira-software.ondemand",e.TRELLO="trello",e.OPSGENIE="opsgenie",e.BITBUCKET="bitbucket.ondemand",e.STATUSPAGE="statuspage"}(I||(I={}))},920670:(e,t,n)=>{"use strict";n.d(t,{cD:()=>o,L7:()=>a,AW:()=>i,ax:()=>l,sY:()=>r,MQ:()=>s,E7:()=>c,pu:()=>d});const o=14,a=30,i="confluence.frontend.growth.reduced.trial.length";let l;!function(e){e.NOT_SUPPORTED="not-supported",e.PRE_TRIAL="pre-trial"}(l||(l={}));const r="persistentUpgradeBanner",s="persistentUpgrade",c="persistent-upgrade",d="upgradeFlow"},221241:(e,t,n)=>{"use strict";n.d(t,{Zr:()=>a});var o=n(920670);const a=({eventAction:e,touchpointSubject:t,currentEdition:n,touchpointId:a,flowId:i})=>({type:"sendUIEvent",data:{action:e,actionSubject:t,source:o.MQ,attributes:{currentEdition:n,touchpointId:a,flowId:i,growthFeature:o.MQ}}})},619208:(e,t,n)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var o=i(n(202784)),a=i(n(382600));function i(e){return e&&e.__esModule?e:{default:e}}const l=e=>o.default.createElement(a.default,Object.assign({dangerouslySetGlyph:'<svg width="24" height="24" viewBox="0 0 24 24" role="presentation"><g fill="currentColor" fill-rule="evenodd"><path d="M15.503 3H12v2h7v14h-7v2h7.006c1.1 0 1.994-.893 1.994-1.995V4.995A1.993 1.993 0 0019.006 3h-3.503z"/><path d="M3.977 11A.99.99 0 003 12.001c0 .551.437.999.977.999h11.047a.988.988 0 00.976-.999.99.99 0 00-.976-1.001H3.977z"/><path d="M12.303 8.305a1.053 1.053 0 000 1.478L14.5 12l-2.197 2.217a1.05 1.05 0 000 1.476c.404.409 1.06.409 1.465 0l2.93-2.955a1.055 1.055 0 000-1.477l-2.93-2.956a1.034 1.034 0 00-1.465 0z"/></g></svg>'},e));l.displayName="SignInIcon";var r=l;t.default=r}}]);
//# sourceMappingURL=1424.Utw8yv6WZq.js.map