WRMCB=function(e){var c=console;if(c&&c.log&&c.error){c.log('Error running batched script.');c.error(e);}}
;
try {
/* module-key = 'com.atlassian.plugins.atlassian-connect-plugin:confluence-macro-api-v5', location = 'v5/js/confluence/utils.js' */
define("ac/confluence/utils",["document"],function(a){return{isFabricEditor:function(){return 0<a.querySelectorAll("[data-fabric-mode]").length}}});
}catch(e){WRMCB(e)};
;
try {
/* module-key = 'com.atlassian.plugins.atlassian-connect-plugin:confluence-macro-api-v5', location = 'v5/js/confluence/macro/macro.js' */
define("ac/confluence/macro",["confluence/root","ajs","ac/confluence/utils"],function(p,f,q){function g(){var a=require("confluence-macro-browser/macro-browser");void 0===a&&(a={getMacroName:function(a){},getMacroParams:function(a){},getMacroBody:function(){throw Error("confluence-macro-browser/macro-browser is unavailable");}});return a}function m(a){var b=a.indexOf("\x3d");if(0<b){var c=a.slice(0,b);a=a.slice(b+1);return{key:c,value:a}}return{}}function n(a){return a.split("|").reduce(function(a,
b){var c=m(b);c.key&&(a[c.key]=c.value);return a},{})}var d=void 0,b={};return{convertRawParamToObject:m,convertRawParamSeriesToObject:n,getMacroBody:function(a){if(f.DarkFeatures.isEnabled("fabric.editor.fix-get-macro-methods")){var e=a._context.extension.options.productContext["macro.id"],c=$('[data-macro-body][data-fabric-macro\x3d"'+e+'"]');if(c.length)a(c.attr("data-macro-body")||"");else if(b&&"string"===typeof b.body)a(b.body);else try{var d=g().getMacroBody(),h=$($.parseXML('\x3croot xmlns:ac\x3d"guid"\x3e'+
d+"\x3c/root\x3e")).find("[ac\\:macro-id\x3d'"+e+"']");1==h.length?a(h.html().replace('xmlns:ac\x3d"guid"',"")):a(d)}catch(r){if(c=a._context.extension.options.productContext,"false"===c["macro.truncated"])a(c["macro.body"]);else{var k=c["page.id"],l=c["page.version"];f.$.ajax({url:f.contextPath()+"/rest/api/content/"+k+"/history/"+l+"/macro/id/"+e,dataType:"json",success:function(b){a(b.body)}})}}}else if(b&&"string"===typeof b.body)a(b.body);else try{d=g().getMacroBody(),e=a._context.extension.options.productContext["macro.id"],
h=$($.parseXML('\x3croot xmlns:ac\x3d"guid"\x3e'+d+"\x3c/root\x3e")).find("[ac\\:macro-id\x3d'"+e+"']"),1==h.length?a(h.html().replace('xmlns:ac\x3d"guid"',"")):a(d)}catch(r){c=a._context.extension.options.productContext,"false"===c["macro.truncated"]?a(c["macro.body"]):(k=c["page.id"],l=c["page.version"],e=c["macro.id"],function t(b,c){c=c||1E3;f.$.ajax({url:f.contextPath()+"/rest/api/content/"+k+"/history/"+l+"/macro/id/"+e,dataType:"json"}).then(function(b){a(b.body)}).fail(function(){0<b&&setTimeout(function(){t(--b)},
c)})}(3,1E3))}},closeCurrentMacroPropertyPanel:function(){f.Confluence.PropertyPanel.destroy()},setLastSelectedConnectMacroNode:function(a){b.locationToInsert=void 0;b.params=void 0;b.body=void 0;b.name=void 0;d=void 0!==g().getMacroName(a)?a:void 0},setUnsavedMacroData:function(a,d,c,f){b.body=d;b.params=c;b.locationToInsert=f;b.name=a},getMacroData:function(a){var e=$('[data-fabric-macro\x3d"'+a._context.extension.options.productContext["macro.id"]+'"]');e.length?a(JSON.parse(e.attr("data-macro-parameters")||
"{}")):void 0===d&&b.params?a(b.params):d?a(g().getMacroParams(d)):a(n(a._context.extension.options.productContext[": \x3d | RAW | \x3d :"]||""))},getCurrentMacroParameters:function(){return void 0===d?b.params:g().getMacroParams(d)},saveMacro:function(){return tinymce.confluence.MacroUtils.updateMacro.apply(this,arguments)},saveCurrentMacro:function(a,e){if(q.isFabricEditor())return require("confluence-macro-browser/macro-browser-facade").insert({name:b.name,params:a,body:e});if(void 0===d){b.params=
a;b.body=e;var c={contentId:p.getContentId(),macro:{name:b.name,params:b.params,body:null===b.body?"":b.body}};f.Rte.getEditor().selection.moveToBookmark(b.locationToInsert);return tinymce.confluence.MacroUtils.insertMacro(c).done(function(a){d=a})}c=g().getMacroName(d);if(void 0!==c)return tinymce.confluence.MacroUtils.updateMacro(a,e,c,d).done(function(a){d=a})}}});
}catch(e){WRMCB(e)};