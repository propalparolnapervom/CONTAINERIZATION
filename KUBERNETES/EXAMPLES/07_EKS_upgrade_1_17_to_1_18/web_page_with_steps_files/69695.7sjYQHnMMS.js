(self._cf=self._cf||[]).push([[69695],{865460:(e,t,n)=>{"use strict";n.d(t,{K:()=>o});const o=n(202784).createContext({lastModificationDate:null});o.displayName="ContentBodyContext"},180518:(e,t,n)=>{"use strict";n.d(t,{q:()=>s});var o=n(230382),i=n.n(o),r=n(604919);const s=i()`query ContentQuery($contentId:ID$versionOverride:Int$embeddedContentRender:String)@SLA{content(id:$contentId version:$versionOverride embeddedContentRender:$embeddedContentRender){nodes{id type space{id key}version{confRev}metadata{lastModifiedDate frontend{fabricEditorSupported spaFriendly}}body{dynamic{representation value webresource{tags{css}uris{js css}}}}...contentAppearancePublishedFragment}}}${r.O}`},765882:(e,t,n)=>{"use strict";n.d(t,{A:()=>l});var o=n(202784),i=n(384684),r=n(230382);const s=n.n(r)()`query ContentViewedEventQuery($contentId:ID){content(id:$contentId trigger:"viewed"){nodes{id}}}`;let a;const l=({contentId:e})=>((0,o.useEffect)((()=>{a=e}),[e]),o.createElement(i.AE,{query:s,variables:{contentId:e},fetchPolicy:"network-only",skip:a===e},(()=>null)));l.displayName="ContentViewedEvent"},995863:(e,t,n)=>{"use strict";function o(e){let t=e.offsetTop;for(;e.offsetParent;)t+=(e=e.offsetParent).offsetTop;return t}function i(e,t){if(!e)return!1;t=t||document.scrollingElement||document.body.parentNode;const n=e.offsetHeight,i=o(e),r=o(t)+t.scrollTop,s=t.offsetHeight;return i>=r&&i+n<=r+s}function r(e){if(!e||e===document)return null;const t=window.getComputedStyle(e);return e.scrollHeight>e.clientHeight&&"hidden"!==e.style.overflow&&"visible"!==t.overflow?e:r(e.parentNode)}function s(e,t){t=t||r(e),e&&t&&!i(e,t)&&(t.scrollTop=o(e)-o(t)-t.clientHeight/2)}function a(e){return e.getBoundingClientRect()}function l(e,t){const n=t?t.documentElement:window.document.documentElement;if(!e||!n)return;const o=e.getBoundingClientRect(),{top:i,bottom:r}=o,s=n.offsetHeight;return 0<=i&&i<s||0<=r&&r<=s||i<=0&&0<=r&&r>=s}function c(e,t){const n=t?t.documentElement:window.document.documentElement;if(!e||!n)return;const o=e.getBoundingClientRect(),{top:i}=o,r=n.offsetHeight;return 0<=i&&i<r}n.d(t,{U4:()=>o,PZ:()=>i,Mm:()=>r,F1:()=>s,Pi:()=>a,VX:()=>l,nX:()=>c})},22478:(e,t,n)=>{"use strict";let o;n.d(t,{q:()=>o}),function(e){e.BYLINE="confluence:contentBylineItem",e.CONTEXT_MENU="confluence:contextMenu",e.CONTENT_ACTION="confluence:contentAction",e.GLOBAL_SETTINGS="confluence:globalSettings",e.HOMEPAGE_FEED="confluence:homepageFeed",e.SPACE_PAGE="confluence:spacePage",e.SPACE_SETTINGS="confluence:spaceSettings",e.TEST_MODULE="test:module"}(o||(o={}))},121203:(e,t,n)=>{"use strict";n.d(t,{_s:()=>i,dy:()=>r,U2:()=>s,bc:()=>a,Zz:()=>l,yd:()=>c});var o=n(768606);const i=(0,o.P)({__loadable_id__:"FwEOx",name:"ByLineForgeApp",loader:async()=>(await Promise.all([n.e(78248),n.e(11216),n.e(75392),n.e(41347),n.e(72005),n.e(85481),n.e(59892),n.e(97691),n.e(15818),n.e(2976),n.e(71962)]).then(n.bind(n,841019))).ByLineForgeApp}),r=(0,o.P)({__loadable_id__:"MJUwt",name:"ContentActionForgeApp",loader:async()=>(await Promise.all([n.e(78248),n.e(11216),n.e(75392),n.e(41347),n.e(72005),n.e(85481),n.e(59892),n.e(97691),n.e(15818),n.e(2976),n.e(89680)]).then(n.bind(n,753404))).ContentActionForgeApp}),s=(0,o.P)({__loadable_id__:"PS0VN",name:"ContextMenuForgeApp",loader:async()=>(await Promise.all([n.e(78248),n.e(11216),n.e(75392),n.e(41347),n.e(72005),n.e(85481),n.e(59892),n.e(97691),n.e(15818),n.e(2976),n.e(32973)]).then(n.bind(n,25572))).ContextMenuForgeApp}),a=(0,o.P)({__loadable_id__:"vuUA2",name:"GlobalSettingsForgeApp",loader:async()=>(await Promise.all([n.e(78248),n.e(11216),n.e(75392),n.e(41347),n.e(72005),n.e(85481),n.e(59892),n.e(97691),n.e(15818),n.e(2976),n.e(19515)]).then(n.bind(n,623858))).GlobalSettingsForgeApp}),l=(0,o.P)({__loadable_id__:"tPS6a",name:"HomepageFeedForgeApp",loader:async()=>(await Promise.all([n.e(78248),n.e(11216),n.e(75392),n.e(41347),n.e(72005),n.e(85481),n.e(59892),n.e(97691),n.e(15818),n.e(2976),n.e(82732)]).then(n.bind(n,452589))).HomepageFeedForgeApp}),c=(0,o.P)({__loadable_id__:"u6Byy",name:"SpaceSettingsForgeApp",loader:async()=>(await Promise.all([n.e(78248),n.e(11216),n.e(75392),n.e(41347),n.e(72005),n.e(85481),n.e(59892),n.e(97691),n.e(15818),n.e(2976),n.e(62741)]).then(n.bind(n,376640))).SpaceSettingsForgeApp});(0,o.P)({__loadable_id__:"2rOIZ",name:"SpacePageForgeApp",loader:async()=>(await Promise.all([n.e(78248),n.e(11216),n.e(75392),n.e(41347),n.e(72005),n.e(85481),n.e(59892),n.e(97691),n.e(15818),n.e(2976),n.e(32661)]).then(n.bind(n,912762))).SpacePageForgeApp})},683748:(e,t,n)=>{"use strict";n.d(t,{R:()=>i});var o=n(202784);const i=({onUpdate:e,popupRef:t,children:n})=>((0,o.useEffect)((()=>{if(!t)return;const n=new MutationObserver((()=>{e()}));return n.observe(t,{childList:!0,subtree:!0}),()=>{n.disconnect()}}),[t]),o.createElement(o.Fragment,null,n));i.displayName="ContentChangeListener"},967630:(e,t,n)=>{"use strict";n.d(t,{Q:()=>i});var o=n(202784);const i=({onClose:e,popupRef:t,triggerRef:n})=>{(0,o.useEffect)((()=>{if(!t)return;const o=({key:t})=>{"Escape"!==t&&"Esc"!==t||e()},i=o=>{document.body.contains(o.target)&&(t&&t.contains(o.target)||n&&n.contains(o.target)||o.target.closest(".atlaskit-portal-container [role=dialog]")||e())};return window.addEventListener("click",i),window.addEventListener("keydown",o),()=>{window.removeEventListener("click",i),window.removeEventListener("keydown",o)}}),[t,n,e])}},10078:(e,t,n)=>{"use strict";n.d(t,{l:()=>i,r:()=>r});var o=n(768606);const i=e=>(0,o.P)({__loadable_id__:"0A4WZ",name:"LazyForgeUIExtensions",loader:async()=>(await Promise.all([n.e(78248),n.e(11216),n.e(75392),n.e(85481),n.e(59892),n.e(15818),n.e(94569)]).then(n.bind(n,179751))).ForgeUIExtensionsWrapper,loading:e}),r=i(void 0)},169322:(e,t,n)=>{"use strict";n.d(t,{L:()=>o});const o=(e,t)=>{const n=t||e.properties.title;let o="";var i;return"PRODUCTION"!==e.environmentType&&(o=` (${i=e.environmentType||"",i&&i.length?i.charAt(0).toUpperCase()+i.slice(1).toLowerCase():""})`),n+o}},26203:(e,t,n)=>{"use strict";n.d(t,{Y:()=>Be});var o=n(151119),i=n(547313),r=n(202784),s=n(830691),a=n(984116),l=n(227371),c=n(943771),d=n(234759),u=n(866380),p=n(175612),m=n(134163),h=n(539099),g=n(544289),f=n(908317),y=n(180213),E=n(349475),v=n(164464),C=n(10078),b=n(22478),S=n(235748),T=n(557098),_=n(239381),x=n(865460),w=n(669021),A=n(187809),N=n(807534),R=n(521940),I=n(972169),O=n(20211),P=n(928316),M=n(995863),F=n(367450),H=n(653586);const L=(0,i.Z)("div",{target:"egsaodj0"})({name:"y7xd18",styles:"@keyframes popup{0%{opacity:0;}100%{opacity:1;}}position:absolute;transition:top 100ms ease-out,left 100ms ease-out;animation:popup 100ms forwards linear;"}),B=(0,i.Z)("div",{target:"egsaodj1"})({name:"1obrnsz",styles:"transform:translate(calc(-50% - 5px),calc(-100% - 20px));box-shadow:rgba(9,30,66,0.6) 0px 4px 8px 0px,rgba(9,30,66,0.31) 0px 0px 1px;border-radius:3px;position:absolute;top:0;left:0;"}),D=(0,i.Z)("div",{target:"egsaodj2"})((({isMenuHorizontal:e})=>e&&"padding: 3px;"),";background-color:#fff;border-radius:3px;display:flex;"),U=(0,i.Z)("div",{target:"egsaodj3"})({name:"1uxknoh",styles:"margin:5px 2px;width:1px;background-color:#ebecf0;"}),k=({children:e,top:t,left:n})=>{const o=(0,r.useRef)(null),[i,s]=(0,r.useState)(n),{featureFlags:a}=(0,F.D)(),l=!a["confluence.frontend.connect.context-menu"];(0,r.useLayoutEffect)((()=>{const{left:e,right:t}=(0,M.Pi)(o.current),n=window.innerWidth;e<0?s(i-e+20):t>n&&s(i-(t-n)-20)}),[o]);const c=document.querySelector(`#${H.z}`);return c?P.createPortal(r.createElement(L,{style:{top:t}},r.createElement(B,{ref:o,style:{left:i},"data-testid":"highlightActionsPopup"},r.createElement(D,{isMenuHorizontal:l},e))),c):null};var Z=n(275392),V=n(343715);const W=(e,t)=>()=>{const n=window.getSelection();n&&window.dispatchEvent(new CustomEvent("create-inline-comment",{detail:(0,V.Wx)(e,n.getRangeAt(0),t)}))},$=(e,t,n)=>()=>{const o=window.getSelection();o&&((0,Z.getAnalyticsWebClient)().then((e=>{e.sendUIEvent({action:"clicked",actionSubject:"button",actionSubjectId:"jiraIssueLink",source:"HighlightContextMenu"}).fire()})),window.dispatchEvent(new CustomEvent("create-jira-issue-summary",{detail:(0,V.Wx)(e,o.getRangeAt(0),t,n)})))},q={firstHighlightShown:!1},G=(0,r.createContext)(q);G.displayName="HighlightActionsContext";var z=n(159394),Y=n(454530),j=n(358056),K=n(885255),J="data-highlighted",X="data-timestamp",Q=1,ee=3,te=["SCRIPT","STYLE","SELECT","OPTION","BUTTON","OBJECT","APPLET","VIDEO","AUDIO","CANVAS","EMBED","PARAM","METER","PROGRESS"];function ne(e,t){return re(e).color()===re(t).color()}function oe(e,t){for(var n in e=e||{},t)t.hasOwnProperty(n)&&void 0===e[n]&&(e[n]=t[n]);return e}function ie(e,t){e.sort((function(e,n){return re(t?n:e).parents().length-re(t?e:n).parents().length}))}var re=function e(t){return{addClass:function(e){t.classList?t.classList.add(e):t.className+=" "+e},removeClass:function(e){t.classList?t.classList.remove(e):t.className=t.className.replace(new RegExp("(^|\\b)"+e+"(\\b|$)","gi")," ")},prepend:function(e){for(var n=Array.prototype.slice.call(e),o=n.length;o--;)t.insertBefore(n[o],t.firstChild)},append:function(e){for(var n=Array.prototype.slice.call(e),o=0,i=n.length;o<i;++o)t.appendChild(n[o])},insertAfter:function(e){return e.parentNode.insertBefore(t,e.nextSibling)},insertBefore:function(e){return e.parentNode.insertBefore(t,e)},remove:function(){t.parentNode.removeChild(t),t=null},contains:function(e){return t!==e&&t.contains(e)},wrap:function(e){return t.parentNode&&t.parentNode.insertBefore(e,t),e.appendChild(t),e},unwrap:function(){var n,o=Array.prototype.slice.call(t.childNodes);return o.forEach((function(t){n=t.parentNode,e(t).insertBefore(t.parentNode),e(n).remove()})),o},parents:function(){for(var e,n=[];e=t.parentNode;)n.push(e),t=e;return n},normalizeTextNodes:function(){if(t){if(t.nodeType===ee)for(;t.nextSibling&&t.nextSibling.nodeType===ee;)t.nodeValue+=t.nextSibling.nodeValue,t.parentNode.removeChild(t.nextSibling);else e(t.firstChild).normalizeTextNodes();e(t.nextSibling).normalizeTextNodes()}},color:function(){return t.style.backgroundColor},fromHTML:function(e){var t=document.createElement("div");return t.innerHTML=e,t.childNodes},getRange:function(){var n,o=e(t).getSelection();return o.rangeCount>0&&(n=o.getRangeAt(0)),n},removeAllRanges:function(){e(t).getSelection().removeAllRanges()},getSelection:function(){return e(t).getWindow().getSelection()},getWindow:function(){return e(t).getDocument().defaultView},getDocument:function(){return t.ownerDocument||t}}};function se(e,t){if(!e)throw"Missing anchor element";this.el=e,this.options=oe(t,{color:"#ffff7b",highlightedClass:"highlighted",contextClass:"highlighter-context",onRemoveHighlight:function(){return!0},onBeforeHighlight:function(){return!0},onAfterHighlight:function(){}}),re(this.el).addClass(this.options.contextClass),this.el}se.prototype.destroy=function(){this.el,re(this.el).removeClass(this.options.contextClass)},se.prototype.highlightHandler=function(){this.doHighlight()},se.prototype.doHighlight=function(e){var t,n,o,i,r=re(this.el).getRange();if(r&&!r.collapsed)return!0===this.options.onBeforeHighlight(r)&&(i=+new Date,(t=se.createWrapper(this.options)).setAttribute(X,i),n=this.highlightRange(r,t),o=this.normalizeHighlights(n),this.options.onAfterHighlight(r,o,i)),e||re(this.el).removeAllRanges(),o},se.prototype.highlightRange=function(e,t){if(!e||e.collapsed)return[];var n,o,i,r=function(e){var t=e.startContainer,n=e.endContainer,o=e.commonAncestorContainer,i=!0;if(0===e.endOffset){for(;!n.previousSibling&&n.parentNode!==o;)n=n.parentNode;n=n.previousSibling}else n.nodeType===ee?e.endOffset<n.nodeValue.length&&n.splitText(e.endOffset):e.endOffset>0&&(n=n.childNodes.item(e.endOffset-1));return t.nodeType===ee?e.startOffset===t.nodeValue.length?i=!1:e.startOffset>0&&n===(t=t.splitText(e.startOffset)).previousSibling&&(n=t):t=e.startOffset<t.childNodes.length?t.childNodes.item(e.startOffset):t.nextSibling,{startContainer:t,endContainer:n,goDeeper:i}}(e),s=r.startContainer,a=r.endContainer,l=r.goDeeper,c=!1,d=s,u=[];do{l&&d.nodeType===ee&&(-1===te.indexOf(d.parentNode.tagName)&&""!==d.nodeValue.trim()&&((o=t.cloneNode(!0)).setAttribute(J,!0),i=d.parentNode,(re(this.el).contains(i)||i===this.el)&&(n=re(d).wrap(o),u.push(n))),l=!1),d!==a||a.hasChildNodes()&&l||(c=!0),d.tagName&&te.indexOf(d.tagName)>-1&&(a.parentNode===d&&(c=!0),l=!1),l&&d.hasChildNodes()?d=d.firstChild:d.nextSibling?(d=d.nextSibling,l=!0):(d=d.parentNode,l=!1)}while(!c);return u},se.prototype.normalizeHighlights=function(e){var t;return this.flattenNestedHighlights(e),this.mergeSiblingHighlights(e),t=e.filter((function(e){return e.parentElement?e:null})),(t=t.filter((function(e,t,n){return n.indexOf(e)===t}))).sort((function(e,t){return e.offsetTop-t.offsetTop||e.offsetLeft-t.offsetLeft})),t},se.prototype.flattenNestedHighlights=function(e){var t,n=this;function o(){var t=!1;return e.forEach((function(o,i){var r=o.parentElement,s=r.previousSibling,a=r.nextSibling;n.isHighlight(r)&&(ne(r,o)?(r.replaceChild(o.firstChild,o),e[i]=r,t=!0):(o.nextSibling||(re(o).insertBefore(a||r),t=!0),o.previousSibling||(re(o).insertAfter(s||r),t=!0),r.hasChildNodes()||re(r).remove()))})),t}ie(e,!0);do{t=o()}while(t)},se.prototype.mergeSiblingHighlights=function(e){var t=this;function n(e,n){return n&&n.nodeType===Q&&ne(e,n)&&t.isHighlight(n)}e.forEach((function(e){var t=e.previousSibling,o=e.nextSibling;n(e,t)&&(re(e).prepend(t.childNodes),re(t).remove()),n(e,o)&&(re(e).append(o.childNodes),re(o).remove()),re(e).normalizeTextNodes()}))},se.prototype.setColor=function(e){this.options.color=e},se.prototype.getColor=function(){return this.options.color},se.prototype.removeHighlights=function(e){var t=e||this.el,n=this.getHighlights({container:t}),o=this;function i(e){re(e).unwrap().forEach((function(e){var t,n,o;n=(t=e).previousSibling,o=t.nextSibling,n&&n.nodeType===ee&&(t.nodeValue=n.nodeValue+t.nodeValue,re(n).remove()),o&&o.nodeType===ee&&(t.nodeValue=t.nodeValue+o.nodeValue,re(o).remove())}))}ie(n,!0),n.forEach((function(e){!0===o.options.onRemoveHighlight(e)&&i(e)}))},se.prototype.getHighlights=function(e){var t=(e=oe(e,{container:this.el,andSelf:!0,grouped:!1})).container.querySelectorAll("["+J+"]"),n=Array.prototype.slice.call(t);return!0===e.andSelf&&e.container.hasAttribute(J)&&n.push(e.container),e.grouped&&(n=function(e){var t=[],n={},o=[];return e.forEach((function(e){var o=e.getAttribute(X);void 0===n[o]&&(n[o]=[],t.push(o)),n[o].push(e)})),t.forEach((function(e){var t=n[e];o.push({chunks:t,timestamp:e,toString:function(){return t.map((function(e){return e.textContent})).join("")}})})),o}(n)),n},se.prototype.isHighlight=function(e){return e&&e.nodeType===Q&&e.hasAttribute(J)},se.prototype.serializeHighlights=function(){var e=this.getHighlights(),t=this.el,n=[];return ie(e,!1),e.forEach((function(e){var o=0,i=e.textContent.length,r=function(e,t){var n,o=[];do{n=Array.prototype.slice.call(e.parentNode.childNodes),o.unshift(n.indexOf(e)),e=e.parentNode}while(e!==t||!e);return o}(e,t),s=e.cloneNode(!0);s.innerHTML="",s=s.outerHTML,e.previousSibling&&e.previousSibling.nodeType===ee&&(o=e.previousSibling.length),n.push([e.textContent,r.join(":"),o,i])})),JSON.stringify(n)},se.prototype.deserializeHighlights=function(e){var t,n=[],o=this;if(!e)return n;try{t=JSON.parse(e)}catch(r){throw"Can't parse JSON: "+r}let i=!0;return t.forEach((function(e){try{!function(e){for(var t,i,r,s={text:e[0],path:e[1].split(":"),offset:e[2],length:e[3]},a=s.path.pop(),l=o.el;r=s.path.shift();)l=l.childNodes[r];l.childNodes[a-1]&&l.childNodes[a-1].nodeType===ee&&(a-=1),(t=(l=l.childNodes[a]).splitText(s.offset)).splitText(s.length),t.nextSibling&&!t.nextSibling.nodeValue&&re(t.nextSibling).remove(),t.previousSibling&&!t.previousSibling.nodeValue&&re(t.previousSibling).remove(),i=re(t).wrap(re().fromHTML(s.wrapper)[0]),n.push(i)}(e)}catch(r){i=!1,console&&console.warn&&console.warn("Can't deserialize highlight descriptor. Cause: "+r)}})),i?n:[]},se.prototype.find=function(e,t){var n=re(this.el).getWindow(),o=n.scrollX,i=n.scrollY,r=void 0===t||t;if(re(this.el).removeAllRanges(),n.find)for(;n.find(e,r);)this.doHighlight(!0);else if(n.document.body.createTextRange){var s=n.document.body.createTextRange();for(s.moveToElementText(this.el);s.findText(e,1,r?4:0)&&(re(this.el).contains(s.parentElement())||s.parentElement()===this.el);)s.select(),this.doHighlight(!0),s.collapse(!1)}re(this.el).removeAllRanges(),n.scrollTo(o,i)},se.createWrapper=function(e){var t=document.createElement("span");return t.style.backgroundColor=e.color,t.className=e.highlightedClass,t};const ae=se;class le{constructor(e,t={}){(0,o.Z)(this,"el",void 0),(0,o.Z)(this,"options",void 0),(0,o.Z)(this,"highlighter",void 0),(0,o.Z)(this,"defaultOptions",{styles:{}}),this.el=e,this.options=(0,z.Z)((0,z.Z)({},this.defaultOptions),t),this.highlighter=new ae(this.el)}highlightRange(e){const t=window.getSelection();return t&&t.empty(),this.highlighter.highlightRange(e,this.createWrapper()),this}removeHighlights(){return this.highlighter.removeHighlights(),this}createWrapper(){const e=document.createElement("span");for(const t in this.options.styles)e.style[t]=this.options.styles[t];return e}}var ce=n(967630),de=n(683748),ue=n(121203),pe=n(491735),me=n(738161);const he=(0,i.Z)("span",{target:"emdedfm0"})("opacity:0;position:absolute;pointer-events:none;top:",(({top:e})=>e),"px;left:",(({left:e})=>e),"px;width:",(({width:e})=>e),"px;height:",(({height:e})=>e),"px;"),ge=(0,i.Z)("div",{target:"emdedfm1"})({name:"evpma",styles:"padding:20px;max-width:500px;max-height:500px;"}),fe={backgroundColor:"#f6c342",boxShadow:"0 2px 2px #ccc"},ye=({content:e,contentId:t,forgeExtension:n,activeSelection:o,onClose:i})=>{const s=(0,r.useContext)(K.F),{spaceKey:a,routeName:l}=(0,r.useContext)(pe.z),c=document.querySelector(`#${H.z}`),[d,u]=(0,r.useState)(null),[p,m]=(0,r.useState)(null),[h,g]=(0,r.useState)({top:0,left:0,width:0,height:0});(0,r.useEffect)((()=>{if(!o.selectedRange)return;if(!c)return;const e=c.getBoundingClientRect(),t=o.selectedRange.getBoundingClientRect();g({top:t.top-e.top,left:t.left-e.left,width:t.width,height:t.height})}),[c,o.selectedRange]),(0,r.useEffect)((()=>{if(!o.selectedRange)return;const t=new le(e,{styles:fe}).removeHighlights().highlightRange(o.selectedRange);return()=>{t.removeHighlights()}}),[e,o.selectedRange]);const f=e=>{u(e)},y=e=>t=>{m(t),e(t)},E=(0,r.useCallback)((()=>{s.succeed({name:T.q.VIEW_PAGE_CONTEXT_MENU_FORGE})}),[s]);return(0,ce.Q)({onClose:i,popupRef:d,triggerRef:p}),c?P.createPortal(r.createElement(j.Z,{testId:"forge-action-popup",content:({update:e})=>r.createElement(ge,{ref:f},r.createElement(de.R,{onUpdate:e,popupRef:d},r.createElement(ue.U2,{app:n,extensionData:{type:b.q.CONTEXT_MENU,selectedText:o.selectedText,content:{id:t,type:(0,me.wg)(l)},space:{key:a}},temporaryContext:{contentId:t,extensionContext:{type:"contextMenu",selectedText:o.selectedText}},onInitialRender:E,onTearDown:i}))),isOpen:!0,placement:"bottom",trigger:e=>{let{ref:t}=e,n=(0,Y.Z)(e,["ref"]);return r.createElement(he,(0,z.Z)((0,z.Z)({"data-testid":"forge-action-selection-span",ref:y(t)},n),{},{top:h.top,left:h.left,width:h.width,height:h.height}))}}),c):null};const Ee=(0,n(36200).j)("highlight-action");var ve=n(642426),Ce=n(261880),be=n(687787),Se=n(32096),Te=n(442298),_e=n(772005),xe=n(169322);const we=(0,i.Z)("div",{target:"e19unanz0"})("display:flex;flex-direction:column;padding-top:8px;padding-bottom:8px;margin:-",(0,Se.Jp)(Te.ww,2),"px -",(0,Se.Jp)(Te.ww,3),"px;overflow-y:auto;max-height:300px;max-width:300px;"),Ae=(0,i.Z)("img",{target:"e19unanz1"})({name:"1m01c8l",styles:"height:24px;width:24px;"}),Ne=(0,i.Z)("div",{target:"e19unanz2"})("width:24px;height:24px;display:inline-block;border-radius:50%;background-color:",p.N20,";display:flex;align-items:center;justify-content:space-around;"),Re=r.createElement(Ne,null,r.createElement(be.default,{label:"No icon",size:"small",secondaryColor:"inherit",primaryColor:p.N40})),Ie=({connectItems:e,forgeItems:t=[],selectForgeExtension:n=(()=>{})})=>{const[o,i]=(0,r.useState)(!1),s=(0,r.useRef)(null);(0,r.useLayoutEffect)((()=>{const{current:e}=s;if(e){const t=e=>{e.stopPropagation()};return e.addEventListener("mouseup",t),()=>{e.removeEventListener("mouseup",t)}}}),[s,s.current]);const a=(0,r.useCallback)((()=>{i(!1)}),[i]),c=(0,r.useMemo)((()=>e.map((e=>{var t;return r.createElement(l.Z,{iconBefore:(null!=(t=e)&&null!=(t=t.icon)?t.path:t)?r.createElement(Ae,{src:e.icon.path}):Re,key:e.completeKey,appearance:"subtle","data-key":e.completeKey,className:e.styleClass,href:e.url,style:{textAlign:"left",borderRadius:0},shouldFitContainer:!0,title:e.label},e.label)}))),[e]),d=(0,r.useMemo)((()=>t.map((t=>{const o=(0,xe.L)(t);return r.createElement(l.Z,{key:t.id,appearance:"subtle",style:{textAlign:"left",paddingLeft:e.length?"40px":"8px",borderRadius:0},onClick:()=>{(0,_e.OV)().start({name:T.q.VIEW_PAGE_CONTEXT_MENU_FORGE,id:t.id,timeout:1e4}),n(t)},shouldFitContainer:!0,title:o},o)}))),[e,t,n]),u=(0,r.useMemo)((()=>r.createElement(we,null,c,d)),[c,d]);return e.length||t.length?r.createElement(ve.Z,{placement:"bottom-start",isOpen:o,onClose:a,content:u},r.createElement(l.Z,{appearance:"subtle",ref:s,isSelected:o,onClick:()=>i(!o),iconBefore:r.createElement(Ce.default,{size:"medium",label:"Drop down"}),style:{borderTopLeftRadius:0,borderBottomLeftRadius:0,height:"36px",margin:0},testId:"context-menu-other-apps"})):null};Ie.displayName="OtherActions";var Oe=n(470841);const Pe=["com.atlassian.confluence.plugins.confluence-inline-comments:create-inline-comment","com.atlassian.confluence.plugins.confluence-jira-content:create-JIRA-issue-summary"],Me=(0,i.Z)("div",{target:"e1hgagbv0"})("padding:2px;display:flex;border-right:1px solid ",p.N30,";");function Fe(){const e=window.getSelection();if(!e||e.isCollapsed)return null;const t=e.getRangeAt(0);return String(t).trim()?t:null}function He(e){return e?3!==e.nodeType&&e.scrollWidth>e.clientWidth?e:He(e.parentNode):null}const Le=e=>e?1===e.nodeType&&e.classList.contains("pm-table-sticky-wrapper")?e:e.parentElement?Le(e.parentElement):null:null;class Be extends r.PureComponent{constructor(...e){super(...e),(0,o.Z)(this,"state",{firstHighlightShown:!1,show:!1,top:0,left:0,forgeExtension:null,activeSelection:null}),(0,o.Z)(this,"mounted",!1),(0,o.Z)(this,"content",r.createRef()),(0,o.Z)(this,"onContainerResized",(()=>{this.setState({show:!1,forgeExtension:null})})),(0,o.Z)(this,"onMouseUp",(e=>requestAnimationFrame((()=>{if(!this.mounted)return;const{isReactInlineCommentsEnabled:t}=this.props,n=Fe(),o=document.querySelector(`#${H.z}`),i=document.querySelector(t?"#inline-comment-sidebar":".ic-sidebar"),r=document.querySelector("#view-all-inline-comments-container");if(!n||!o||!this.content.current||null!=r&&r.contains(n.startContainer)||null!=r&&r.contains(n.endContainer)||null!=i&&i.contains(n.startContainer)||null!=i&&i.contains(n.endContainer)||!this.content.current.contains(e.target)&&this.content.current!==e.target&&!e.target.closest("button[disabled]"))return void this.setState({show:!1});const s=o.getBoundingClientRect(),a=this.content.current.getBoundingClientRect(),l=n.getClientRects();if(!l||!l.length)return void this.setState({show:!1});const c=Array.from(l).find((e=>0!==e.width&&0!==e.height));if(c){const{left:t,right:o,top:i,width:r}=c,l=e.clientX,d=t+(r>>1);let u=a.left,p=a.right;const m=He(n.startContainer);if(m){const e=m.getBoundingClientRect();u=Math.max(u,e.left),p=Math.min(p,e.right)}let h=Math.abs(l-d)>100&&t<=l&&l<=o?l:d;h=Math.max(u,Math.min(p,h)),this.setState({firstHighlightShown:!0,show:!0,left:h-s.left,top:i-s.top})}})))),(0,o.Z)(this,"createReactInlineCommentHighlight",((e,t,n,o,i)=>{const r=window.getSelection();if(r){const s=(0,V.Wx)(this.content.current,r.getRangeAt(0),t),{searchText:{numMatches:a,index:l,selectedText:c}}=s;e({numMatches:a,matchIndex:l,selectedText:c}),o&&!i&&n&&n(!0)}})),(0,o.Z)(this,"handleCommentButtonClick",((e,t,n)=>{const{hasContentChanged:o,createComment:i,viewAllInlineComments:r,isViewAllInlineCommentsVisible:s}=t,{contentId:a}=this.props;o?e.showDialog(I.v,{onConfirm:()=>this.createReactInlineCommentHighlight(i,a,r,n,s)}):this.createReactInlineCommentHighlight(i,a,r,n,s)})),(0,o.Z)(this,"createInlineCommentButton",((e,t)=>{if(!this.content.current)return null;const{contentId:n,isReactInlineCommentsEnabled:o}=this.props,i="view-all-inline-comments"===t.getVariantValue("confluence.frontend.view.all.inline.comments",{default:"not-enrolled",shouldTrackExposureEvent:!1,oneOf:["single-inline-comment","not-enrolled","view-all-inline-comments"]}),c=((e,t)=>{const n=window.getSelection();if(!n)return!1;let o;try{o=(0,V.Wx)(e,n.getRangeAt(0),t)}catch(a){Ee.error`An error occured on highlighting content`}if(!o||!o.searchText)return!1;const{searchText:{selectedText:i,index:r,numMatches:s}}=o;return i.replace(/\n/g,"").length>0&&-1!==r&&s>0&&r<s})(this.content.current,n),p=r.createElement(a.xs,{to:[O.l]},(t=>r.createElement(A.V.Consumer,null,(({viewAllInlineComments:a,isViewAllInlineCommentsVisible:u})=>r.createElement(N.s.Consumer,null,(({createComment:p})=>r.createElement(R.i.Consumer,null,(({hasContentChanged:m})=>{const h={hasContentChanged:m,createComment:p,viewAllInlineComments:a,isViewAllInlineCommentsVisible:u};return r.createElement(l.Z,{appearance:"subtle",iconBefore:r.createElement(d.default,{size:"medium",label:""}),"data-key":e,isDisabled:!c,testId:"createInlineCommentButton",onClick:o?()=>{this.handleCommentButtonClick(t,h,i)}:W(this.content.current,n)},r.createElement(s._H,{id:"highlight-actions.inline-comments.comment",defaultMessage:"Comment",description:"Make a new comment"}))}))))))));return c?r.createElement(r.Fragment,{key:"inline-comment-button"},p):r.createElement(u.Z,{key:"inline-comment-button",delay:0,position:"top",content:r.createElement(s._H,{id:"highlight-actions.inline-comments.comment.unsupported",defaultMessage:"Comments can only be added to text that doesn’t contain an emoji, a macro, or an @mention"})},p)})),(0,o.Z)(this,"renderBuiltInWebItemActions",((e,t)=>{if(!this.content.current)return null;const n=e.map((e=>{const{completeKey:n}=e;return"com.atlassian.confluence.plugins.confluence-inline-comments:create-inline-comment"===n?this.createInlineCommentButton(n,t):"com.atlassian.confluence.plugins.confluence-jira-content:create-JIRA-issue-summary"===n?this.createJiraIssueButton(n):void 0}));return r.createElement(Me,{key:"built-in-actions"},this.getComponentsWithDivider(n))}))}componentDidMount(){this.mounted=!0,window.addEventListener("mouseup",this.onMouseUp),window.addEventListener("highlight-actions.container.resized",this.onContainerResized),(0,m.M)({contentId:this.props.contentId,location:h.Y.ACTION_PANEL})}componentWillUnmount(){this.mounted=!1,window.removeEventListener("mouseup",this.onMouseUp),window.removeEventListener("highlight-actions.container.resized",this.onContainerResized)}createJiraIssueButton(e){if(!this.content.current)return null;const{contentId:t}=this.props;return r.createElement(x.K.Consumer,{key:"jira-issue-button"},(({lastModificationDate:n})=>r.createElement(l.Z,{appearance:"subtle",iconBefore:r.createElement(c.default,{size:"medium",label:""}),"data-key":e,testId:"createJiraIssueButton",onClick:$(this.content.current,t,n)},r.createElement(s._H,{id:"highlight-actions.create-issue",defaultMessage:"Create issue",description:"Create a new Jira issue"}))))}getComponentsWithDivider(e){const{length:t}=e;return e.reduce(((e,n,o)=>(e.push(n),o!==t-1&&e.push(r.createElement(U,{key:`divider-${o}`})),e)),[])}createGenericButton({styleClass:e,completeKey:t,label:n}){return r.createElement(l.Z,{key:t,appearance:"subtle","data-key":t,className:e},n)}getComponentsForHorizontalPopup(e,t){const n=e.map((e=>{const{completeKey:n}=e;return n.endsWith("create-inline-comment")?this.createInlineCommentButton(n,t):n.endsWith("create-JIRA-issue-summary")?this.createJiraIssueButton(n):this.createGenericButton(e)}));return this.getComponentsWithDivider(n)}getComponentsForPopup(e,t=[],n){const o=e.filter((e=>Pe.includes(e.completeKey))),i=e.filter((e=>!Pe.includes(e.completeKey)));return o.length||i.length||t.length?[this.renderBuiltInWebItemActions(o,n),r.createElement(Ie,{key:"other-components",connectItems:i,forgeItems:t,selectForgeExtension:e=>{const t=Fe();if(!t)return;const n=(0,Oe.q)(String(t)).trim();n&&this.setState({forgeExtension:e,activeSelection:{selectedText:n,selectedRange:t}})}})]:[]}renderPopup(e){const{top:t,left:n}=this.state;return e.length?r.createElement(a.xs,{to:[w.S]},(o=>{let i=0;const s=Fe();if(s){const e=Le(s.commonAncestorContainer);e&&o&&(i=o.getTotalHeight()+e.clientHeight)}return r.createElement(r.Fragment,null,r.createElement(k,{top:i+t,left:n},e),r.createElement(S.F,{name:T.q.VIEW_PAGE_CONTEXT_MENU}))})):null}render(){const{children:e,contentId:t}=this.props,{forgeExtension:n,activeSelection:o,show:i}=this.state;return r.createElement(r.Fragment,null,r.createElement(E.p9,{featureFlag:"confluence.frontend.forge.extension-point.context-menu"},r.createElement(C.r,{moduleType:b.q.CONTEXT_MENU,render:()=>r.createElement(r.Fragment,null)}),n&&o&&!i&&r.createElement(ye,{content:this.content.current,contentId:t,forgeExtension:n,activeSelection:o,onClose:()=>{this.setState({forgeExtension:null})}})),r.createElement(G.Provider,{value:{firstHighlightShown:this.state.firstHighlightShown}},r.createElement("div",{key:"content-container",ref:this.content},e)),r.createElement(f.S,{attribution:y.x.BACKBONE},i?r.createElement(r.Fragment,null,r.createElement(_.U,{id:t,name:T.q.VIEW_PAGE_CONTEXT_MENU}),r.createElement(g.p,{key:"action-panel",contentId:t,location:h.Y.ACTION_PANEL,fetchPolicy:"cache-first"},(({webItems:e})=>r.createElement(v.e,null,(({featureFlags:t,featureFlagClient:n})=>t["confluence.frontend.connect.context-menu"]?t["confluence.frontend.forge.extension-point.context-menu"]?r.createElement(C.r,{moduleType:b.q.CONTEXT_MENU,render:t=>this.renderPopup(this.getComponentsForPopup(e,t,n))}):this.renderPopup(this.getComponentsForPopup(e,[],n)):this.renderPopup(this.getComponentsForHorizontalPopup(e,n))))))):null))}}Be.displayName="HighlightActions"},827333:(e,t,n)=>{"use strict";n.d(t,{Zn:()=>i,Ex:()=>r,Qo:()=>s});var o=n(768606);const i=(0,o.P)({__loadable_id__:"ClZmW",name:"RestrictedPage",loader:async()=>(await Promise.all([n.e(78248),n.e(11216),n.e(75392),n.e(41347),n.e(72005),n.e(37382),n.e(33731),n.e(7807),n.e(75415),n.e(19377)]).then(n.bind(n,419377))).RestrictedPage}),r=(0,o.P)({__loadable_id__:"EhdjM",name:"RestrictedSpace",loader:async()=>(await Promise.all([n.e(78248),n.e(11216),n.e(75392),n.e(41347),n.e(72005),n.e(37382),n.e(33731),n.e(7807),n.e(75415),n.e(16590)]).then(n.bind(n,216590))).RestrictedSpace}),s=(0,o.P)({__loadable_id__:"/SH9f",name:"RestrictedPageConfirmation",loader:async()=>(await Promise.all([n.e(78248),n.e(11216),n.e(80875)]).then(n.bind(n,835689))).RestrictedPageConfirmation})},247636:(e,t,n)=>{"use strict";n.d(t,{Z:()=>r});var o=n(772005),i=n(496054);const r=async(e,{name:t,timeout:n,attributes:r})=>{(0,o.OV)().start({name:t,timeout:n||i.O.PAGE_LOAD,attributes:r});try{await e()}catch(s){throw(0,o.Cf)(t,s),s}(0,o.OV)().succeed({name:t})}},891330:(e,t,n)=>{"use strict";n.d(t,{t:()=>r});var o=n(202784),i=n(365917);const r=e=>{const{contentId:t,registerReloader:n}=(0,o.useContext)(i.qC);(0,o.useEffect)((()=>{n(e)}),[t,e.reload,e.name])}},349475:(e,t,n)=>{"use strict";n.d(t,{p9:()=>i,by:()=>r});var o=n(768606);const i=(0,o.P)({__loadable_id__:"ys7y/",name:"RenderForFeatureFlag",loader:async()=>(await Promise.all([n.e(78248),n.e(11216),n.e(75392),n.e(77401)]).then(n.bind(n,677401))).RenderForFeatureFlag}),r=((0,o.P)({__loadable_id__:"gL5sb",name:"WrapForFeatureFlag",loader:async()=>(await Promise.all([n.e(78248),n.e(11216),n.e(75392),n.e(93040)]).then(n.bind(n,993040))).WrapForFeatureFlag}),(0,o.P)({__loadable_id__:"7v/wv",name:"RenderForUserPermissionType",loader:async()=>(await Promise.all([n.e(78248),n.e(11216),n.e(75392),n.e(41347),n.e(84360)]).then(n.bind(n,384360))).RenderForUserPermissionType}))},738161:(e,t,n)=>{"use strict";n.d(t,{Gh:()=>a,wg:()=>l,PP:()=>c,dj:()=>d});var o=n(846575),i=n(251467),r=n(230382);const s=n.n(r)()`query ExperimentalFetchShareableTeams($queryString:String!$limit:Int!=20)@experimental{experimentalFetchShareableTeams(queryString:$queryString limit:$limit){nodes{id smallAvatarImageUrl displayName description memberCount includesYou}}}`,a=(e,t,n,o)=>{switch(n){case"page":return`ari:cloud:confluence:${t}:page/${e}`;case"blogpost":return`ari:cloud:confluence:${t}:blog/${e}`;case"space":return`ari:cloud:confluence:${t}:space/${o}`;default:return`ari:cloud:confluence:${t}:page/${e}`}},l=e=>e?e.includes("BLOG")?"blogpost":e.includes("PAGE")?"page":e.includes("SPACE")?"space":"page":"page",c=e=>((e,t)=>{const n=[e,t].map((e=>e.then((e=>({value:e,status:"fulfilled"})),(e=>({error:e,status:"rejected"})))));return Promise.all(n).then((e=>{if(e.every((e=>"rejected"===e.status)))return Promise.reject("Failed to fetch any Shareable Entities");const t=e.filter((e=>"fulfilled"===e.status)).reduce(((e,t)=>[...e,...t.value]),[]);return Promise.resolve(t)}))})((async e=>e?(0,o.WQ)().query({query:i.b,variables:{searchTerm:e.toLowerCase()}}).then((({data:e})=>{const{users:t=[],groups:n=[]}=e.userGroupSearch,o=t.map((e=>({id:e.accountId,name:e.displayName,type:e.type||"user",avatarUrl:e.profilePicture.path}))),i=n.map((e=>({id:e.id,name:e.name,type:"group"})));return o.concat(i)})):Promise.resolve([]))(e),(async e=>(0,o.WQ)().query({query:s,variables:{queryString:e,limit:20}}).then((({data:e})=>{const{nodes:t=[]}=e.experimentalFetchShareableTeams;return t.map((e=>{return{type:"team",id:(t=e.id,t.replace("ari:cloud:teams::team/","")),avatarUrl:e.smallAvatarImageUrl,name:e.displayName,description:e.description,memberCount:e.memberCount,includesYou:e.includesYou};var t}))})))(e)),d=e=>{try{return JSON.parse(e)}catch(t){}return null}},251467:(e,t,n)=>{"use strict";n.d(t,{b:()=>i});var o=n(230382);const i=n.n(o)()`query UserAndGroupSearchQuery($searchTerm:String!$maxResults:Int=50$withGroups:Boolean=true$sitePermissionTypeFilter:SitePermissionTypeFilter=NONE){userGroupSearch(query:$searchTerm maxResults:$maxResults sitePermissionTypeFilter:$sitePermissionTypeFilter){users{type displayName profilePicture{path}...on User{accountId}...on KnownUser{accountId}}groups@include(if:$withGroups){id name}}}`},134163:(e,t,n)=>{"use strict";n.d(t,{M:()=>r});var o=n(12841),i=n(840187);function r({location:e=null,contentId:t=null,spaceKey:n=null,version:r=null}={}){const s={location:Array.isArray(e)?null:e,locations:Array.isArray(e)?e:[],contentId:t,spaceKey:n,version:r};return(0,o.I)({query:i.W,variables:s})}},539099:(e,t,n)=>{"use strict";n.d(t,{Y:()=>o});const o={TOOLS_MENU_CONTAINER:"system.content.action",TOOLS_MENU_MARKER:"system.content.action/marker",TOOLS_MENU_LEADING:"system.content.action/leading",TOOLS_MENU_PRIMARY:"system.content.action/primary",TOOLS_MENU_SECONDARY:"system.content.action/secondary",TOOLS_MENU_MODIFY:"system.content.action/modify",PAGE_BUTTONS:"system.content.button",SYSTEM_DASHBOARD:"system.dashboard",SYSTEM_DASHBOARD_BUTTON:"system.dashboard.button",SYSTEM_CONTENT_BYLINE:"system.content.byline",SYSTEM_CONTENT_METADATA:"system.content.metadata",PAGE_METADATA_BANNER:"page.metadata.banner",SYSTEM_HEADER_LEFT:"system.header/left",SYSTEM_HEADER_LEFT_BUTTON_GROUP:"system.header/left.button.group",SYSTEM_HELP:"system.help/pages",SYSTEM_USER_ANONYMOUS:"system.user/anonymous",SYSTEM_USER:"system.user",SYSTEM_ADMIN_SITE_SECTION:"system.admin.site/site_admin_section",SPACE_SIDEBAR:"system.space.sidebar/main-links",SYSTEM_ADMIN:"system.admin",SYSTEM_EDITOR_LINK_BROWSER_TABS:"system.editor.link.browser.tabs",SYSTEM_EDITOR_PRECURSOR_BUTTONS:"system.editor.precursor.buttons",CREATE_DIALOG:"system.create.dialog/content",ACTION_PANEL:"page.view.selection/action-panel",DASHBOARD_LEFT:"atl.dashboard.left",DASHBOARD_SECONDARY:"atl.dashboard.secondary",ATL_GENERAL:"atl.general",ATL_FOOTER:"atl.footer",ATL_PAGE_METADATA:"atl.page.metadata.banner",ATL_PAGE_CONTENT_FOOTER_ACTIONS:"atl.page.content.footer.actions",ATL_EDITOR_SAVEBAR:"atl.editor.savebar",SYSTEM_ADMIN_SITE_ADMINISTRATION:"system.admin/siteadministration",SYSTEM_ADMIN_SITE_ADMINISTRATION_SECURITY:"system.admin/security"}},236130:(e,t,n)=>{"use strict";n.d(t,{K:()=>o});(0,n(36200).j)("wrm");function o(e,t){if(!t.length)return Promise.resolve();const n=window.document.createDocumentFragment(),o=t.map((e=>new Promise(((t,o)=>{const i=window.document.createElement("script");i.async=!1,i.src=e,i.onload=t,i.onerror=o,n.appendChild(i)}))));return e.appendChild(n),Promise.all(o).catch(((...e)=>{0}))}},476630:(e,t,n)=>{"use strict";n.d(t,{M:()=>i});var o=n(494775);function i(e){return e?e.replace(/href="(.*_\/styles\/[^\/"]*)"/g,((e,t)=>t.includes(".css")?`href="${o.b+t.substring(t.indexOf("/_")+2)}"`:e)):e}}}]);
//# sourceMappingURL=69695.7sjYQHnMMS.js.map