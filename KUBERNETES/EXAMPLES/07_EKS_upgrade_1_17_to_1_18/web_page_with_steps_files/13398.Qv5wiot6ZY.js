(self._cf=self._cf||[]).push([[13398],{865525:(e,t,n)=>{"use strict";n.d(t,{k:()=>i});var r=n(536631),s=n(860764),o=n(283544),a=n(422663);const i=(0,r.default)((e=>e&&"function"==typeof e.push?{smartCard:{onClick(t,n){const r=(0,o.H)(t,e);r&&r===n?(t.preventDefault(),e.push(r,(0,s.q)())):c(t,n)}}}:void 0)),c=(e,t)=>{(0,a.L)(e,{shouldCheckIframe:!0})?window.open(t,"_blank"):window.open(t,"_self")}},422663:(e,t,n)=>{"use strict";n.d(t,{L:()=>r});const r=(e,t)=>(null==e?void 0:e.isDefaultPrevented())&&(Boolean(null==t?void 0:t.shouldCheckIframe)&&s()||a(e)||o(e)),s=()=>window.parent!==parent,o=e=>1===(null==e?void 0:e.nativeEvent).button,a=e=>{const t=null==e?void 0:e.nativeEvent;return t.ctrlKey||t.metaKey}},554013:(e,t,n)=>{"use strict";n.d(t,{C:()=>a});var r=n(159394),s=n(202784),o=n(165929);function a(e){function t(t){const n=(0,s.useContext)(o.k);return s.createElement(e,(0,r.Z)((0,r.Z)({},n),t))}return t.displayName=`withExternalShareContext(${e.displayName||e.name})`,t}},523971:(e,t,n)=>{"use strict";n.d(t,{k:()=>a});var r=n(159394),s=n(202784),o=n(367450);function a(e){function t(t){const n=(0,o.D)();return s.createElement(e,(0,r.Z)({sessionData:n},t))}return t.displayName=`withSessionData(${e.displayName||e.name})`,t}},513398:(e,t,n)=>{"use strict";n.d(t,{Z:()=>le});var r=n(159394),s=n(151119),o=n(547313),a=n(536631),i=n(202784),c=n(830691),l=n(572827),d=n(984116),u=n(183883),h=n.n(u),p=n(857503),f=n(578996),m=n(435756),v=n(656485),I=n(336545),g=n(618046),y=n(215041),b=n(275392),w=n(865525),P=n(937523),k=n(669021),C=n(587939);class E{constructor(e){this.flushIntervalMs=e,(0,s.Z)(this,"flushIntervalId",void 0),(0,s.Z)(this,"onFlushCallback",void 0),(0,s.Z)(this,"currentBatch",[]),(0,s.Z)(this,"flush",(()=>{const e=this.renewBatch();if(this.unscheduleFlush(),0!==e.length)try{this.onFlushCallback&&this.onFlushCallback(e)}catch(t){setTimeout((()=>{throw console.error('"onFlush" callback threw the below error. Please make sure your callbacks have proper error handling'),t}),0)}}))}add(e){this.scheduleFlush(),this.currentBatch=this.currentBatch.filter((t=>t.objectKey.localId!==e.objectKey.localId)),this.currentBatch.push(e)}onFlush(e){if(!(e instanceof Function))throw new Error(`"onFlush" callback is supposed to be a function; saw ${typeof e} instead`);this.onFlushCallback=e}forceFlush(){this.flush()}renewBatch(){const e=this.currentBatch;return this.currentBatch=[],e}scheduleFlush(){this.flushIntervalId||(this.flushIntervalId=window.setInterval(this.flush,this.flushIntervalMs))}unscheduleFlush(){this.flushIntervalId&&(window.clearInterval(this.flushIntervalId),this.flushIntervalId=void 0)}}var T=n(230382);const x=n.n(T)()`mutation SetBatchedTaskStatus($contentId:ID!$tasks:[InlineTask]!){setBatchedTaskStatus(batchedInlineTasksInput:{contentId:$contentId tasks:$tasks trigger:VIEW_PAGE}){success}}`;var Z=n(761766),F=n(267083),H=n(146457),R=n(525231),j=n(172581),N=n(714922),S=n(846575),_=n(164464),B=n(462019),D=n(624588);var A=n(646354),K=n(494775),U=n(670390),V=n(195833);var W=n(905930),$=n(554013),M=n(523971),q=n(302931),L=n(766361),O=n(945233);const X=e=>!!e&&!!e["confluence.frontend.fabric.renderer.table.sorting"],Q=e=>!!e&&!!e[O.iD],G=e=>!!e&&!!e["confluence.frontend.fabric.renderer.sticky-headers"],J=e=>!!e&&!!e["confluence.frontend.open.expand.when.following.link"],Y=e=>!!e&&!!e["confluence.frontend.fabric.editor.codeblock.copy"],z=e=>{if(!e)return;const t=e["confluence.frontend.fabric.renderer.ttr-severity-tracking"];if("string"==typeof t)try{return JSON.parse(t)}catch(n){0}},ee=e=>!(null==e||!e["confluence.frontend.fabric.editor.select.all.trap"]);var te=n(397377),ne=n(914957);function re(e){return t=>{t.update((t=>(0,r.Z)((0,r.Z)({},t),{},{attributes:(0,r.Z)((0,r.Z)({},t.attributes),{},{objectId:e})})))}}const se=(0,o.Z)("div",{target:"emrguq00"})(A.kU),oe="requested";class ae extends i.PureComponent{constructor(...e){super(...e),(0,s.Z)(this,"state",{_root:void 0,rerender:"",taskBatcher:new E(3e3)}),(0,s.Z)(this,"_handleActionToggle",((e,t)=>{this.state.taskBatcher.add({objectKey:e,state:t})})),(0,s.Z)(this,"_onBatchTaskUpdate",(e=>{const{objectId:t}=this.props,n={contentId:t,tasks:e.map((e=>{const{objectKey:t,state:n}=e,r="DONE"===n?"CHECKED":"UNCHECKED";return{taskId:t.localId,status:r}})),trigger:"VIEW_PAGE"};(0,S.WQ)().mutate({mutation:x,variables:n}).catch((e=>{(0,b.getAnalyticsWebClient)().then((t=>{t.sendOperationalEvent({source:"page",action:"batchTaskUpdate",actionSubject:"checkbox",attributes:{error:e.message||String(e),stack:e.stack}})}))}))})),(0,s.Z)(this,"_handleProfileCardActions",(e=>{const{inProductPeopleDirectory:t,push:n}=this.props;return[{label:this.props.intl.formatMessage({id:"view.profile"}),callback:()=>{t?n((0,U.p)(e,null,K.b)):h().open((0,U.p)(e,null),"_blank").focus()}}]})),(0,s.Z)(this,"getExpandHash",(()=>this.state.rerender===oe?"":this.props.getHash())),(0,s.Z)(this,"getExtensionHandlers",(e=>{const{objectId:t,spaceKey:n,showTemplateVariablesInPreview:r,showTemplateInputInPreview:s,isJposMacroEnabled:o}=this.props;return(0,L.V)({contentId:t,showTemplateVariablesInPreview:r,showTemplateInputInPreview:s,spaceKey:n,isJposMacroEnabled:o,shouldIncludeMacroHandlers:e})})),(0,s.Z)(this,"_handleMediaClick",(e=>{const{objectId:t,openPreviewer:n}=this.props;n({parentId:t,item:e.mediaItemDetails})})),(0,s.Z)(this,"getEventHandlers",(()=>{const{isMediaViewerNextGen:e,matchRoute:t,push:n}=this.props,s=e?void 0:{onClick:this._handleMediaClick};return(0,r.Z)({media:s},(0,w.k)({matchRoute:t,push:n}))})),(0,s.Z)(this,"_setRoot",(e=>this.setState({_root:e}))),(0,s.Z)(this,"shouldUseExtensionV2",((e={})=>e[g.Px]||!1)),(0,s.Z)(this,"getProfilecardProvider",((e,t)=>(0,Z.t)(e,t))),(0,s.Z)(this,"getProviders",(0,a.default)((e=>{const{intl:t,accountId:n,containerId:r,contentType:s,cloudId:o,environment:a,featureFlags:i,objectId:c,spaceKey:l,isExternalShareRequest:d,sessionData:u,showTemplateInputInPreview:h,showTemplateVariablesInPreview:m}=this.props;let I;i&&i["confluence.frontend.batch.tasks"]&&(I=this._handleActionToggle);const g=p.Z.create({mediaProvider:(0,F.Pp)({contentId:c,isExternalShare:d}),taskDecisionProvider:Promise.resolve(new H.Y(t,e,c,I)),cardProvider:Promise.resolve(new v.Vj)});return o&&n&&g.setProvider("mentionProvider",(0,R.Z)(o,n).then((e=>e.mentionResource)).catch((e=>Promise.reject()))),o&&null!=u&&u.isLicensed&&(g.setProvider("emojiProvider",(0,N.T5)(f.ZP,{cloudId:o,source:"view"})),(async()=>{const e=await(0,_.g)(),{featureFlags:t}=e;if(!t[D.q])return!0;const{data:n,errors:r}=await(0,S.WQ)().query({query:B._,errorPolicy:"all"});return!!r||!!(n&&n.globalOperations&&n.globalOperations.length>0&&n.globalOperations.some((e=>e&&"read"===e.operation&&"userProfile"===e.targetType)))})().then((e=>{e&&g.setProvider("profilecardProvider",this.getProfilecardProvider(o,this._handleProfileCardActions))}))),r&&g.setProvider("contextIdentifierProvider",Promise.resolve({containerId:r,objectId:c,product:"confluence"})),(0,te.R)(g,{intl:t,contentId:c,containerId:r,accountId:n,cloudId:o,spaceKey:l,contentType:s,environment:a,featureFlags:i,extensionHandlers:this.getExtensionHandlers(!0),showTemplateInputInPreview:h,showTemplateVariablesInPreview:m}),g}))),(0,s.Z)(this,"handleClicksInRenderer",(e=>{if(e.target.hash===`#${this.getExpandHash()}`){const e=document.getElementById(decodeURIComponent(this.getExpandHash()));if(e){const t=e.closest("[data-node-type='expand']");t&&"false"===t.getAttribute("data-expanded")&&this.setState({rerender:oe})}}})),(0,s.Z)(this,"renderRenderer",((e,t)=>{var n,s;const{adf:o,id:a,className:c,style:l,allowInlineComments:d,ignoreHeadingAnchorLinksFeatureFlag:u,renderWhenReady:h,onComplete:p,featureFlags:f,objectId:I}=this.props;if(!o)return null;const g=!u&&(e=>!!e&&!!e["confluence.frontend.fabric.renderer.heading.anchor"])(f),{offsetTop:y,appearance:b}=this.props,w="mobile"!==b&&void 0!==y&&G(f)&&{offsetTop:y},P=(e=>!!e&&!!e["confluence.frontend.fabric.renderer-spec-based-validator"])(f);return i.createElement(se,{id:a,"data-inline-comments-target":d?"true":"false",className:c,ref:this._setRoot,style:(0,r.Z)({},l),"data-test-appearance":this.props.appearance},i.createElement(v.zt,null,i.createElement("div",{onClick:J(f)?this.handleClicksInRenderer:void 0},i.createElement(ne.Z,{onEvent:re(I),channel:"editor"},i.createElement(m.ZP,{allowDynamicTextSizing:!1,appearance:this.props.appearance,document:null!==(n=null===(s=this.props.navigationPolicy)||void 0===s?void 0:s.shimAdfUrls(o))&&void 0!==n?n:o,adfStage:"stage0",dataProviders:t,eventHandlers:this.getEventHandlers(),extensionHandlers:e,portal:this.state._root,onComplete:p,allowColumnSorting:X(f),allowHeadingAnchorLinks:J(f)?{allowNestedHeaderLinks:g,activeHeadingId:decodeURIComponent(this.getExpandHash())}:g,allowAltTextOnImages:!0,media:{allowLinking:Q(f),featureFlags:(0,j.N)(f)},stickyHeaders:w,useSpecBasedValidator:P,allowCopyToClipboard:Y(f),analyticsEventSeverityTracking:z(f),allowSelectAllTrap:ee(f)})))),h&&h())})),(0,s.Z)(this,"renderRendererWithXen",((e,t,n,r,s,o)=>{const a=(0,I.jX)(t);return i.createElement(y.vO,{analyticsWebClient:(0,b.getAnalyticsWebClient)(),apolloClient:a,contextIds:e,dataProviders:s,forgeContext:n,forgeUIAnalyticsContext:r,environment:(0,I.a)(t),product:"confluence",page:"confluence:macroRenderer"},(()=>{const e=!this.shouldUseExtensionV2(o);return i.createElement(i.Fragment,null,this.renderRenderer(this.getExtensionHandlers(e),s))}))}))}componentDidMount(){const{adf:e,sessionData:t}=this.props;e&&null!=t&&t.isLicensed&&(0,P.a)(),this.state.taskBatcher.onFlush(this._onBatchTaskUpdate)}componentDidUpdate(e){const{rerender:t}=this.state;t===oe&&this.setState({rerender:""})}componentWillUnmount(){const{adf:e,sessionData:t}=this.props;e&&null!=t&&t.isLicensed&&(0,P.X)()}render(){h().performance.mark("CFP-63.view.page.classic.renderer.rendered");const{accountId:e,cloudId:t,containerId:n,contentType:r,environment:s,featureFlags:o,objectId:a,spaceKey:c}=this.props,l=`ari:cloud:confluence::site/${t}`,u=!this.shouldUseExtensionV2(o);return i.createElement(i.Fragment,null,i.createElement(d.xs,{to:[q.Q]},(i=>{const d=this.getProviders(i);return o&&o["confluence.frontend.forge.macro.renderer.next"]?this.renderRenderer(this.getExtensionHandlers(u),d):this.renderRendererWithXen([l],s,(0,I.Ti)(e,t,a,c),(0,I.dN)({objectId:a,objectType:r,containerId:n,containerType:"space"}),d,o)})))}}ae.displayName="RendererComponent",(0,s.Z)(ae,"contextTypes",{store:l.$l.isRequired});const ie=(0,c.XN)(function(e){function t(t){const n=(0,V.f)();return i.createElement(e,(0,r.Z)((0,r.Z)({},t),{},{navigationPolicy:n}))}return t.displayName=`withNavigationPolicy(${e.displayName||e.name})`,t}(ae));class ce extends i.PureComponent{render(){const{featureFlags:e,allowStickyHeaders:t}=this.props;return G(e)&&!1!==t?i.createElement(d.xs,{to:[k.S,C.f]},((e,t)=>{const n=e.getTotalHeight()+t.getFloatingHeight();return i.createElement(ie,(0,r.Z)({offsetTop:n},this.props))})):i.createElement(ie,(0,r.Z)({},this.props))}}ce.displayName="RendererComponentWithBanner",(0,s.Z)(ce,"contextTypes",{store:l.$l.isRequired});const le=(0,$.C)((0,M.k)((0,W.h)(ce)))},397377:(e,t,n)=>{"use strict";n.d(t,{R:()=>u});var r=n(668417),s=n(848347),o=n(215041),a=n(336545),i=n(618046),c=n(275392),l=n(406664),d=n(999600);const u=(e,{intl:t,containerId:n,accountId:u,cloudId:h,spaceKey:p,contentId:f,contentType:m,environment:v,featureFlags:I,extensionHandlers:g,showTemplateInputInPreview:y,showTemplateVariablesInPreview:b})=>{const w=[];((e={})=>Boolean(e[i.Px]))(I)&&(w.push((0,l.u)({contentId:f,spaceKey:p,features:{}},g)),(y||b)&&w.push(new r.Z([(0,d.u)(t,y?d.N.INPUT:d.N.CONFIG)])));const P=(0,a.jX)(),k=[`ari:cloud:confluence::site/${h}`],C=I&&I["confluence.frontend.forge.macro.renderer.next"]?(0,o.sj)({accountId:null!=u?u:void 0,cloudId:h,apolloClient:P,contextIds:k,dataProviders:e,environment:(0,a.a)(v),product:"confluence",page:"confluence:macroRenderer",isEditing:!1,analyticsWebClient:(0,c.getAnalyticsWebClient)(),forgeUIAnalyticsContext:(0,a.dN)({objectId:f,objectType:m,containerId:n,containerType:"space"}),extensionData:(0,a.YQ)({spaceKey:p,contentId:f}),temporaryContext:(0,a.Ti)(u,h,f,p),shouldRenderHostedResources:I&&I["confluence.frontend.forge.hosted-resources"]}):(0,o.jV)(P,k,h,e,(0,a.a)(v),"confluence","confluence:macroRenderer",(0,a.YQ)({spaceKey:p,contentId:f}),(0,a.Ti)(u,h,f,p),null!=u?u:void 0,!1,(0,c.getAnalyticsWebClient)(),(0,a.dN)({contentId:f,objectType:m,containerId:n,containerType:"space"}),I&&I["confluence.frontend.forge.hosted-resources"]);w.push(C),w.length>0&&e.setProvider("extensionProvider",Promise.resolve((0,s.Z)(w)))}}}]);
//# sourceMappingURL=13398.Qv5wiot6ZY.js.map